<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ongoing mint</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.6/dist/bootstrap-table.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="icon" href="asset/breakfast.jpeg" type="image/x-icon">
  <style>
    .pagecontents {
      background-color: #1b1b1b !important;
      color: white !important;
    }

    body {
      background-color: #1b1b1b;
      color: white;
    }

    /* Table Header Background Color */
   .table thead th {
        color: white; /* White text */
    }

    .table tbody {
        color: white;
    }

    .table tbody tr:hover {
        color: white;
    }

    .btn-rounded {
      border-radius: 25px;
    }
  </style>
</head>
<body>
  <div class='dashboard'>
    
    <div class="dashboard-nav">
        <header>
          <a href="#hop" class="menu-toggle">
            <i class="fas fa-bars"> </i>
          </a>
          <a class="brand-logo">
            <img src="/asset/breakfast_mini.png" style="width: 32px; height: 32px;">
            <span>Breakfast</span>
          </a>
        </header>
        <nav class="dashboard-nav-list">
          <a href="/" class="dashboard-nav-item"> <i class="fas fa-home"></i> Home </a>
          <a href="/mybalance" class="dashboard-nav-item"> <i class="fas fa-wallet"></i> Spot </a>
          <a href="/deploy" class="dashboard-nav-item "><i class="fas fa-wifi"></i> Deploy </a>

            <div class='dashboard-nav-dropdown active'><a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle"><i
                    class="fas fa-hand-holding-usd"></i> Mint </a>
                <div class='dashboard-nav-dropdown-menu'>
                  <a href="/ongoingmint" class="dashboard-nav-dropdown-item active">Active</a>
                  <a href="/upcomingmint" class="dashboard-nav-dropdown-item">Coming soon</a>
                  <a href="/passedmint" class="dashboard-nav-dropdown-item">Completed</a>                   
                  </div>
            </div>
            <div class='dashboard-nav-dropdown'><a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle"><i
                    class="fas fa-exchange-alt"></i> My Operations </a>
                <div class='dashboard-nav-dropdown-menu'>
                  <a href="/mymints"  class="dashboard-nav-dropdown-item">Mint</a>
                  <a href="/mydeploy" class="dashboard-nav-dropdown-item">Deploy</a>  
                  <a href="/myburn" class="dashboard-nav-dropdown-item">Burn</a>
                  <a href="/mytransfer" class="dashboard-nav-dropdown-item">Transfer</a>
                  <a href="#" class="dashboard-nav-dropdown-item">Airdrop</a>                  
                  </div>
            </div>
          
        </nav>
    </div>

    <div class='dashboard-app'>
        
        <header class='dashboard-toolbar'>
          <a href="#!" class="menu-toggle">
            <i class="fas fa-bars"></i>
          </a>
          <div id="wallet-info" class="navbar-text ml-auto" style="display: none;">
            <span id="public-key"></span>
            <span id="balance"></span>
      
            <a href="#" id="disconnect" style="color: white;" ><i class="fas fa-sign-out-alt"></i> </a>
          </div>
        </header>
        
        <div class='dashboard-content pagecontents'>
            <div class=' '>
                <div class='card pagecontents'>
                    <div class='card-header'>
                        <h1>In progress Mint ðŸ”¥</h1>
                    </div>
                    <div class='card-body'>
                       
                        
                      <table
                      id="table"
                      data-toolbar="#toolbar"
                      data-search="true"
                      data-show-refresh="false"
                      data-show-toggle="false"
                      data-show-fullscreen="false"
                      data-show-columns="true"
                      data-show-columns-toggle-all="true"
                      data-detail-view="false"
                      data-show-export="false"
                      data-click-to-select="false"
                      data-detail-formatter="detailFormatter"
                      data-minimum-count-columns="2"
                      data-show-pagination-switch="false"
                      data-pagination="true"
                      data-id-field="id"
                      data-page-list="[10, 25, 50, 100, all]"
                      data-show-footer="false"
                      data-toggle="table"
                      data-height="800"
                      data-url=""
                      data-response-handler="responseHandler">
                    </table>


                    </div>
                </div>
            </div>
        </div>


    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.29.0/tableExport.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.6/dist/bootstrap-table.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.6/dist/bootstrap-table-locale-all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.6/dist/extensions/export/bootstrap-table-export.min.js"></script>
  
  <script src="ongoingmint.bundle.js"></script>

  <script>
    var $table = $('#table');
  
    var selections = [];
  
    function getIdSelections() {
      return $.map($table.bootstrapTable('getSelections'), function (row) {
        return row.id;
      });
    }
  
    function responseHandler(res) {
      $.each(res.rows, function (i, row) {
        row.state = $.inArray(row.id, selections) !== -1;
      });
      return res;
    }
  
    function operateFormatter(value, row, index) {
      return [
        '<button class="btn btn-primary mint btn-rounded" type="button">Mint</button>',
      ].join('');
    }

    function logoFormatter(value, row, index) {
      //return '<img src="' + value + '" alt="Logo" style="width: 50px; height: 50px;"/>';
      return ` <a href="/token?name=${row.name}"  target="_blank" rel="noopener noreferrer">
                              <img src=${value} alt="Logo" style="width: 50px; height: 50px;" class="logo" > 
                  </a> `;
    }

    function progressFormatter(value, row, index) {
      return `
        <div class="progress">
          <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger" role="progressbar" aria-valuenow="${value}" aria-valuemin="0" aria-valuemax="100" style="width: ${value}%"></div>
        </div>`;
    }

    function convertTimestamp(value, row, index) {
            if (value.toString().length === 10) {
              value *= 1000;
            }
            const date = new Date(value);
            const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are zero-based
            const day = String(date.getDate()).padStart(2, '0');
            const year = date.getFullYear();
            return `${month}/${day}/${year}`;
        }

    function formatEnglish(value, row, index) {
      return value ? value.toLocaleString('en-US') : 0;
    }

    window.operateEvents = {
        'click .mint': function (e, value, row, index) {
          window.open('/token?name=' + row.name, '_blank');
          //alert('You click like action, row: ' + JSON.stringify(row.name))
        }
    }
  
  
    function initTable() {
      $table.bootstrapTable('destroy').bootstrapTable({
        height: 550,
        locale: 'en-US',
        columns: [
          {
            title: '',
            field: 'logo',
            align: 'center',
            valign: 'middle',
            sortable: false,
            formatter: logoFormatter
          },
          {
            title: 'Name',
            field: 'name',
            align: 'center',
            valign: 'middle',
            sortable: true
          },
          {
            title: 'Total Supply',
            field: 'max',
            align: 'center',
            valign: 'middle',
            sortable: true,
            formatter: formatEnglish
          },
          {
            title: 'Mints',
            field: 'mints',
            align: 'center',
            valign: 'middle',
            sortable: true,
            formatter: formatEnglish
          },
          {
            title: 'Holders',
            field: 'holders',
            align: 'center',
            valign: 'middle',
            sortable: true,
            formatter: formatEnglish
          },
          {
            title: 'Premine (%)',
            field: 'premine',
            align: 'center',
            valign: 'middle',
            sortable: true
          },
          {
            title: 'Date',
            field: 'blockTime',
            align: 'center',
            valign: 'middle',
            sortable: true,
            formatter: convertTimestamp 
          },
          {
            title: 'Progress',
            field: 'progress',
            align: 'center',
            valign: 'middle',
            sortable: true,
            formatter: progressFormatter
          },
          {
            title: 'Airdrop',
            field: 'operate',
            align: 'center',
            valign: 'middle',
            clickToSelect: false,
            events: window.operateEvents,
            formatter: operateFormatter
          }
        ]
      });

      
  
      $table.on('check.bs.table uncheck.bs.table ' +
        'check-all.bs.table uncheck-all.bs.table',
        function () {
          selections = getIdSelections();
        });
  
      $table.on('all.bs.table', function (e, name, args) {
        //console.log(name, args);
      });
  
      
    }
  
    $(function () {
      initTable();
      $('#locale').change(initTable);
      updateTable();
    });

    function updateTable() {
            const table = $('#table');
            const newUrl = `/api/mint/ongoing`;
            table.bootstrapTable('refresh', { url: newUrl });
    }
  </script>
</body>
</html>
